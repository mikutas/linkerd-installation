repositories:
- name: linkerd
  url: https://helm.linkerd.io/stable
- name: linkerd-edge
  url: https://helm.linkerd.io/edge

releases:
- name: linkerd-viz
  namespace: linkerd-viz
  createNamespace: true
  chart: linkerd/linkerd-viz
  # https://github.com/linkerd/linkerd2/blob/stable-2.14.2/viz/charts/linkerd-viz/Chart.yaml
  version: 30.12.3
  hooks:
  - events: ["presync"]
    showlogs: true
    command: kubectl
    args: ["wait", "deploy/linkerd-proxy-injector", "-n=linkerd", "--for=condition=available", "--timeout=3m"]
  # - events: ["postsync"]
  #   showlogs: true
  #   command: kubectl
  #   args: ["apply", "-f", "ingress.yaml"]
